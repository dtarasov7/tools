–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä—ã OSD –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤ –∏–º–µ–Ω–∏ –ø—Ä–µ—Ñ–∏–∫—Å–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –¶–û–î–∞, –≤–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —è–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —É–∫–∞–∑–∞—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ OSD –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –¶–û–î—É. –≠—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ **inventory.yml**.

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –¶–û–î

1. **–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –¶–û–î –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ:**
   –í —Å–µ–∫—Ü–∏–∏ `osds` —É–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `datacenter` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞:

   ```yaml
   all:
     children:
       osds:
         hosts:
           osd1:
             datacenter: dc1
           osd2:
             datacenter: dc1
           osd3:
             datacenter: dc1
           osd4:
             datacenter: dc2
           osd5:
             datacenter: dc2
           osd6:
             datacenter: dc2
   ```

2. **–û–±–Ω–æ–≤–∏—Ç–µ `crush_location` –≤ `group_vars/osds.yml`:**
   –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏–∫—É –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¶–û–î–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `datacenter` –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:

   ```yaml
   crush_location:
     root: default
     datacenter: "{{ hostvars[inventory_hostname]['datacenter'] }}"  # –ò–∑–≤–ª–µ–∫–∞–µ—Ç datacenter –∏–∑ inventory
     host: "{{ inventory_hostname }}"
   ```

---

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- **–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `datacenter`:**
  –¢–µ–ø–µ—Ä—å –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é, –≤ –∫–∞–∫–æ–º –¶–û–î–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä OSD.
  
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `datacenter`:**
  –ö–æ–¥ `{{ hostvars[inventory_hostname]['datacenter'] }}` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `datacenter`, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —É–∑–ª–∞ (`inventory_hostname`).

---

### –ü—Ä–∏–º–µ—Ä –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è:
```yaml
all:
  vars:
    ansible_user: ceph
    ansible_ssh_private_key_file: /path/to/ssh/key
    ceph_origin: repository
    ceph_repository: community
    ceph_stable_release: quincy
    public_network: <Frontend-—Å–µ—Ç—å>
    cluster_network: <Backend-—Å–µ—Ç—å>
    osd_pool_default_size: 3
    osd_pool_default_min_size: 1

  children:
    mons:
      hosts:
        dc1-mon1:
        dc2-mon2:
        dc3-mon3:
    osds:
      hosts:
        osd1:
          datacenter: dc1
        osd2:
          datacenter: dc1
        osd3:
          datacenter: dc1
        osd4:
          datacenter: dc2
        osd5:
          datacenter: dc2
        osd6:
          datacenter: dc2
```

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ CRUSH-—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è:
–ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
ceph osd tree
```
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ OSD –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –¶–û–î–∞–º `dc1` –∏ `dc2`.

–ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä