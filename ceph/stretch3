–í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã, —Å–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–º–µ—á–∞–Ω–∏–µ! –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è OSD —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–π –º–µ–∂–¥—É **dc1** –∏ **dc2**, –∞ MON/MGR —Å–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –æ–¥–Ω–æ–º—É –≤ –∫–∞–∂–¥–æ–º –¶–û–î–µ. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —ç—Ç–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º.

---

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç `crush_rule_config`:
–¢–µ–ø–µ—Ä—å OSD —Å–µ—Ä–≤–µ—Ä–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É **dc1** –∏ **dc2**:

```yaml
crush_rule_config:
  - name: stretch-rule
    type: replicated
    failure_domain: host
    device_class: hdd
    datacenters:
      - name: dc1
        weight: 1
        hosts:
          - dc1-osd1
          - dc1-osd2
          - dc1-osd3
      - name: dc2
        weight: 1
        hosts:
          - dc2-osd4
          - dc2-osd5
          - dc2-osd6
```

---

### –ü–æ–ª–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å (`inventory.yml`) –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
–¢–µ–ø–µ—Ä—å –≤—Å–µ OSD —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É **dc1** –∏ **dc2**, –∞ MON (–∏ MGR) —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî –ø–æ –æ–¥–Ω–æ–º—É –≤ –∫–∞–∂–¥–æ–º –¶–û–î–µ.

```yaml
all:
  vars:
    ansible_user: ceph
    ansible_ssh_private_key_file: /path/to/ssh/key
    ceph_origin: repository
    ceph_repository: community
    ceph_stable_release: quincy
    public_network: <Frontend-—Å–µ—Ç—å>
    cluster_network: <Backend-—Å–µ—Ç—å>
    osd_pool_default_size: 3
    osd_pool_default_min_size: 1
    mon_allow_pool_delete: true
    mon_group: stretch
    ceph_conf_overrides:
      global:
        mon_osd_full_ratio: 0.95
        mon_osd_nearfull_ratio: 0.85
        mon_max_pg_per_osd: 300

  children:
    mons:
      hosts:
        dc1-mon1:
        dc2-mon2:
        dc3-mon3:
    osds:
      hosts:
        dc1-osd1:
        dc1-osd2:
        dc1-osd3:
        dc2-osd4:
        dc2-osd5:
        dc2-osd6:
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `group_vars/osds.yml`:
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–∞–∂–¥—ã–π OSD –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CRUSH-—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è:

```yaml
crush_location:
  root: default
  datacenter: "{{ ansible_hostname.split('-')[0] }}"  # –ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –¶–û–î–∞ –∏–∑ –∏–º–µ–Ω–∏ —É–∑–ª–∞
  host: "{{ inventory_hostname }}"
```

---

### –ß—Ç–æ —ç—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
1. **–†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ OSD –º–µ–∂–¥—É –¶–û–î–∞–º–∏ dc1 –∏ dc2.**
   - –í –∫–∞–∂–¥–æ–º –¶–û–î –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ 3 —Å–µ—Ä–≤–µ—Ä–∞ OSD.
2. **–¢–æ—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ MON —Å–µ—Ä–≤–µ—Ä–æ–≤:**
   - –û–¥–∏–Ω MON –≤ –∫–∞–∂–¥–æ–º –∏–∑ dc1, dc2, dc3 –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–≤–æ—Ä—É–º–∞.
3. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Stretch Mode:**
   - –î–∞–Ω–Ω—ã–µ —Ä–µ–ø–ª–∏—Ü–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É dc1 –∏ dc2, –∞ MON —Å–µ—Ä–≤–µ—Ä—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å.

–ï—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–º–æ—â—å –∏–ª–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä
