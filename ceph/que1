ceph 17.2.7 
–û–ø–∏—à–∏ –∏–µ—Ä–∞—Ä—Ö–∏—é —Å—É—â–Ω–æ—Å—Ç–µ–π –¥–ª—è S3
–û–ø–∏—à–∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ –∏–∑ —Ä–∞–∑–º–µ—Ä—É –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º, —É—á–∏—Ç—ã–≤–∞—è —á—Ç–æ OSD —Å–µ—Ä–≤–µ—Ä–æ–≤ 6 —à—Ç—É–∫ –∏ –Ω–∞ –∫–∞–∂–¥–æ–º –ø–æ 6 SSD.
ChatGPT —Å–∫–∞–∑–∞–ª:
–ò–µ—Ä–∞—Ä—Ö–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π –¥–ª—è S3 –≤ Ceph 17.2.7 (Quincy)
Ceph RADOS Gateway (RGW) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å S3 API. –í–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ Ceph —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—É—â–Ω–æ—Å—Ç–µ–π –¥–ª—è S3 –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User)
–û–ø–∏—Å–∞–Ω–∏–µ:
S3-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ Ceph RGW. –£ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞: Access Key –∏ Secret Key.

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∫–µ—Ç–∞–º–∏ –∏ –æ–±—ä–µ–∫—Ç–∞–º–∏ —á–µ—Ä–µ–∑ S3 API.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–∫–µ—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (1000 –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).

–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ø—É–ª—É –¥–∞–Ω–Ω—ã—Ö.

2. –ë–∞–∫–µ—Ç (Bucket)
–û–ø–∏—Å–∞–Ω–∏–µ:
–õ–æ–≥–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤. –ë–∞–∫–µ—Ç —Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã, —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—â—ë–Ω–Ω—ã–µ –≤ –ø—É–ª–∞—Ö –¥–∞–Ω–Ω—ã—Ö (RADOS pools).

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

–ë–∞–∫–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 1000 —É—Ä–æ–≤–Ω—è–º–∏ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞–∑–Ω—ã–µ –∫–ª–∞—Å—Å—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, STANDARD, COLD).

–†–∞–∑–º–µ—Ä—ã:

–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –±–∞–∫–µ—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Ç–æ–ª—å–∫–æ –æ–±—ä—ë–º–æ–º –ø—É–ª–∞ –¥–∞–Ω–Ω—ã—Ö.

3. –û–±—ä–µ–∫—Ç (Object)
–û–ø–∏—Å–∞–Ω–∏–µ:
–•—Ä–∞–Ω–∏–º–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∫–µ—Ç–µ. –û–±—ä–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç:

–°–∞–º–∏ –¥–∞–Ω–Ω—ã–µ (–ø–æ–º–µ—â–∞—é—Ç—Å—è –≤ –ø—É–ª –¥–∞–Ω–Ω—ã—Ö).

–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏–Ω–¥–µ–∫—Å–∞—Ö).

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞: 5 –¢–ë.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Multipart Upload –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã.

4. –ü—É–ª (Pool)
–û–ø–∏—Å–∞–Ω–∏–µ:
–§–∏–∑–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ Ceph. –û–±—ä–µ–∫—Ç—ã –∏ –∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø—É–ª–∞—Ö.

–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö:

–î–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–æ–≤: –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—É–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, default.rgw.buckets.data).

–ò–Ω–¥–µ–∫—Å—ã –æ–±—ä–µ–∫—Ç–æ–≤: –•—Ä–∞–Ω—è—Ç—Å—è –≤ –∏–Ω–¥–µ–∫—Å–Ω–æ–º –ø—É–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, default.rgw.buckets.index).

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É–ª—ã –¥–ª—è –ª–æ–≥–æ–≤ –∏ –º–µ—Ç—Ä–∏–∫.

5. –ó–æ–Ω—ã (Zone) –∏ –ó–æ–Ω–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã (ZoneGroup)
ZoneGroup: –õ–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–æ–Ω.

Zone: –ö–∞–∂–¥–∞—è –∑–æ–Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø—É–ª–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö.

–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:

–†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏ Multi-Site: –î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ä–µ–≥–∏–æ–Ω–∞–º–∏.

–ó–æ–Ω–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –µ–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

–ò–µ—Ä–∞—Ä—Ö–∏—è: –í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
User
 ‚îî‚îÄ‚îÄ Bucket(s)
      ‚îî‚îÄ‚îÄ Object(s)
           ‚îî‚îÄ‚îÄ Pool(s)
ZoneGroup
 ‚îî‚îÄ‚îÄ Zone(s)
      ‚îî‚îÄ‚îÄ Pool(s)
–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º S3, —É—á–∏—Ç—ã–≤–∞—è 6 OSD —Å–µ—Ä–≤–µ—Ä–æ–≤ (36 SSD)
1. –†–∞–∑–º–µ—Ä –±–∞–∫–µ—Ç–æ–≤
–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–∞–∫–µ—Ç–∞:

–†–∞–∑–º–µ—Ä –±–∞–∫–µ—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —á–∞—Å—Ç–æ—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 1‚Äì50 –¢–ë –Ω–∞ –±–∞–∫–µ—Ç.

–î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∏—Ç–µ –æ–±—ä–µ–∫—Ç—ã –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–∫–µ—Ç–æ–≤.

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –±–∞–∫–µ—Ç–µ:

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 10 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –±–∞–∫–µ—Ç–µ.

–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —É–∑–∫–∏—Ö –º–µ—Å—Ç –≤ –∏–Ω–¥–µ–∫—Å–Ω—ã—Ö –ø—É–ª–∞—Ö.

2. –†–∞–∑–º–µ—Ä –æ–±—ä–µ–∫—Ç–æ–≤
–†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞:

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5 –¢–ë.

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏: 100 –ú–ë ‚Äì 1 –ì–ë.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Multipart Upload –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.

Multipart Upload:

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞: 5 –ú–ë.

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞: 64 –ú–ë ‚Äì 128 –ú–ë.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: –¥–æ 10 000 —á–∞—Å—Ç–µ–π –Ω–∞ –æ–±—ä–µ–∫—Ç.

3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–ª–æ–≤
–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

–•—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø—É–ª–µ default.rgw.buckets.data.

–ò–Ω–¥–µ–∫—Å—ã (–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ) ‚Äî –≤ –ø—É–ª–µ default.rgw.buckets.index.

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ PG (Placement Groups): –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ PG –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (OSD * 100) / Number_of_pools
–ü—Ä–∏–º–µ—Ä –¥–ª—è –ø—É–ª–∞ –¥–∞–Ω–Ω—ã—Ö:

36 OSD (6 —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ 6 –¥–∏—Å–∫–æ–≤):
–ï—Å–ª–∏ 3 –ø—É–ª–∞, —Ç–æ:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (36 * 100) / 3 = 1200
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ 1200 PG –¥–ª—è –ø—É–ª–∞ default.rgw.buckets.data.

4. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫:

–î–ª—è RGW –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 3 —Ä–µ–ø–ª–∏–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).

–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ –¥–æ –¥–≤—É—Ö OSD.

Erasure Coding (EC):

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –±–æ–ª–µ–µ —ç–∫–æ–Ω–æ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ EC-–∫–æ–¥—ã:

k=4, m=2: –•—Ä–∞–Ω–µ–Ω–∏–µ 6 —á–∞—Å—Ç–µ–π, 2 —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ (66% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å).

EC-–∫–æ–¥—ã –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è RGW
CRUSH-–ø—Ä–∞–≤–∏–ª–æ:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CRUSH-–ø—Ä–∞–≤–∏–ª–æ –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd crush rule create-replicated rgw_rule default host
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –∫ RGW –ø—É–ª–∞–º:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set default.rgw.buckets.data crush_rule rgw_rule
–ü—É–ª—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:

–ò–Ω–¥–µ–∫—Å–Ω—ã–µ –ø—É–ª—ã (default.rgw.buckets.index) —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –Ω–∞ SSD:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set default.rgw.buckets.index target_size_ratio 0.1
6. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫:

–í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ RGW:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
radosgw-admin log show
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Ceph Dashboard –∏–ª–∏ Prometheus.

–õ–∏–º–∏—Ç—ã S3:

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
radosgw-admin user modify --uid=myuser --max-buckets=1000
–†–µ–∑—é–º–µ
–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –±–∞–∫–µ—Ç–∞: 1‚Äì50 –¢–ë, –¥–æ 10 –º–ª–Ω –æ–±—ä–µ–∫—Ç–æ–≤.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Multipart Upload –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤.

–†–∞–∑–¥–µ–ª—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø—É–ª–∞–º (data, index) —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ PG –∏ CRUSH.

–†–µ–ø–ª–∏–∫–∞—Ü–∏—è: 3 –∫–æ–ø–∏–∏, –ª–∏–±–æ Erasure Coding (k=4, m=2) –¥–ª—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏.

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏–ª–∏ –ø–æ–º–æ—â—å —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π ‚Äî –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üòä







–í—ã —Å–∫–∞–∑–∞–ª–∏:
–æ—Ç —á–µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ pg –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ?
ChatGPT —Å–∫–∞–∑–∞–ª:
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG (Placement Groups) –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Ceph –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤:
PG (Placement Groups) ‚Äî —ç—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É OSD (Object Storage Daemons) –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Ceph. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –ø–∞–º—è—Ç—å—é –∏ –º–∞—Å—à—Ç–∞–±–æ–º –∫–ª–∞—Å—Ç–µ—Ä–∞.

1. –§–∞–∫—Ç–æ—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG
1.1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ OSD –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
–ö–∞–∂–¥—ã–π OSD —Ö—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ PG, –∫–æ—Ç–æ—Ä—ã–º –æ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç.

–ß–µ–º –±–æ–ª—å—à–µ OSD –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, —Ç–µ–º –±–æ–ª—å—à–µ PG –º–æ–∂–µ—Ç –±—ã—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ.

1.2. –ü–∞–º—è—Ç—å OSD
–ö–∞–∂–¥—ã–π PG —Ç—Ä–µ–±—É–µ—Ç –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ OSD –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø–µ—Ä–∞—Ü–∏–π.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–¥–µ–ª—è—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ 1 –ú–ë –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ –∫–∞–∂–¥—É—é PG.
–ù–∞–ø—Ä–∏–º–µ—Ä:

–î–ª—è 1000 PG —Ç—Ä–µ–±—É–µ—Ç—Å—è ~1 –ì–ë RAM –Ω–∞ –∫–∞–∂–¥—ã–π OSD.

–î–ª—è 10 000 PG –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è ~10 –ì–ë RAM –Ω–∞ OSD.

1.3. –ú–æ—â–Ω–æ—Å—Ç—å MON (–º–æ–Ω–∏—Ç–æ—Ä–æ–≤)
MON —Ö—Ä–∞–Ω—è—Ç –∫–∞—Ä—Ç—É –∫–ª–∞—Å—Ç–µ—Ä–∞ (CRUSH Map) –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ –≤—Å–µ—Ö PG.

–ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ MON, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è PG.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å—ã MON –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —á–∏—Å–ª–∞ PG.

1.4. CRUSH Map
CRUSH Map –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ, –∫–∞–∫ PG —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –º–µ–∂–¥—É OSD.

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ CRUSH-–ø—Ä–∞–≤–∏–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—É–ª–æ–≤, –∑–æ–Ω) —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ PG.

1.5. –û–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É–ª–æ–≤
PG –¥–µ–ª—è—Ç—Å—è –º–µ–∂–¥—É –ø—É–ª–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

–ß–µ–º –±–æ–ª—å—à–µ –ø—É–ª–æ–≤, —Ç–µ–º –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –Ω–∞ –ø—É–ª:

–î–ª—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏: –º–∏–Ω–∏–º—É–º 32 PG –Ω–∞ –ø—É–ª.

–î–ª—è Erasure Coding: –º–∏–Ω–∏–º—É–º 64 PG –Ω–∞ –ø—É–ª.

2. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG
2.1. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ PG:

–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ OSD –∏ MON.

–ú–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö (recovery, backfill).

–°–ª–∏—à–∫–æ–º –º–∞–ª–æ PG:

–ü—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥–∏—Å–±–∞–ª–∞–Ω—Å—É –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É OSD (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ OSD –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω—ã).

2.2. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É PG
Ceph —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (Total_OSD * 100) / Replica_Size
–ü—Ä–∏–º–µ—Ä:
36 OSD (6 —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø–æ 6 –¥–∏—Å–∫–æ–≤).

–†–µ–ø–ª–∏–∫–∞—Ü–∏—è: 3 –∫–æ–ø–∏–∏.

–û–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É–ª–æ–≤: 5.

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (36 * 100) / 3 = 1200
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG_per_pool = Total_PG / Number_of_Pools
PG_per_pool = 1200 / 5 = 240
2.3. –õ–∏–º–∏—Ç—ã PG –≤ Ceph
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: Ceph –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –ø—É–ª–µ:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool default pg num max = 32,768
–≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å, –Ω–æ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph config set osd osd_max_pg_per_osd <new_limit>
–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–µ –ø—Ä–µ–≤—ã—à–∞—Ç—å 1‚Äì4 –º–∏–ª–ª–∏–æ–Ω–∞ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ MON –∏ OSD.

3. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
–ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π—Ç–µ OSD:

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –Ω–µ –±–æ–ª–µ–µ 200‚Äì300 PG –Ω–∞ –æ–¥–∏–Ω OSD.

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ OSD.

–£–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ PG –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ:

–ò–∑–±–µ–≥–∞–π—Ç–µ —Ä–µ–∑–∫–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è PG, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (rebalancing).

–£–≤–µ–ª–∏—á–µ–Ω–∏–µ PG:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set <pool-name> pg_num <new_pg_num>
ceph osd pool set <pool-name> pgp_num <new_pg_num>
–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ MON:

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä—ã –∏–º–µ—é—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –∏ CPU –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ–π PG.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Erasure Coding –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ:

EC —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ PG, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥—ã–π –æ–±—ä–µ–∫—Ç —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 64 PG –Ω–∞ –ø—É–ª —Å EC.

4. –í—ã–≤–æ–¥
–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:
–ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ OSD.

–û–±—ä—ë–º–∞ –ø–∞–º—è—Ç–∏ OSD.

–°–ª–æ–∂–Ω–æ—Å—Ç–∏ CRUSH Map.

–û–∂–∏–¥–∞–µ–º–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—É–ª–æ–≤.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 200‚Äì300 PG –Ω–∞ OSD.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É–ª—É:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (Total_OSD * 100) / Replica_Size
–ò–∑–±–µ–≥–∞–π—Ç–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è 4 –º–∏–ª–ª–∏–æ–Ω–æ–≤ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

–ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–º–æ—â—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π PG –∏–ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üöÄüòä







–í—ã —Å–∫–∞–∑–∞–ª–∏:
–∫–∞–∫ –∑–∞–¥–∞–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ pg –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π pool?
ChatGPT —Å–∫–∞–∑–∞–ª:
–ö–∞–∫ –∑–∞–¥–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG (Placement Groups) –¥–ª—è –ø—É–ª–∞ –≤ Ceph
–í Ceph, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –¥–ª—è –ø—É–ª–∞ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ pg_num (–æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –¥–ª—è –ø—É–ª–∞) –∏ pgp_num (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG, –∫–æ—Ç–æ—Ä—ã–µ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö). –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞.

1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ pg_num –∏ pgp_num –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—É–ª–∞
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ pg_num
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –¥–ª—è –ø—É–ª–∞:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set <pool-name> pg_num <desired_pg_num>
–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ pgp_num
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set <pool-name> pgp_num <desired_pg_num>
2. –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ PG –¥–ª—è –ø—É–ª–∞
–®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pg_num
–î–æ–ø—É—Å—Ç–∏–º, –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–¥–∞—Ç—å 512 PG –¥–ª—è –ø—É–ª–∞ —Å –∏–º–µ–Ω–µ–º my-pool:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set my-pool pg_num 512
–®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pgp_num
–ó–∞–¥–∞–π—Ç–µ pgp_num —Ä–∞–≤–Ω—ã–º pg_num, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set my-pool pgp_num 512
3. –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
3.1. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É pg_num –∏ pgp_num
pg_num: –ó–∞–¥–∞—ë—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –¥–ª—è –ø—É–ª–∞.

pgp_num: –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∏–∑ —ç—Ç–∏—Ö PG –∞–∫—Ç–∏–≤–Ω–æ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

–ï—Å–ª–∏ pgp_num < pg_num, –¥–∞–Ω–Ω—ã–µ –Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –≤—Å–µ PG –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

–î–ª—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö pgp_num –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–≤–µ–Ω pg_num.

3.2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ pg_num –≤—ã–∑—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ PG —Ç—Ä–µ–±—É–µ—Ç —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—É–ª–µ, —á—Ç–æ –º–æ–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä.

–í—Å–µ–≥–¥–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ PG –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç 256 –¥–æ 512, –∑–∞—Ç–µ–º –¥–æ 1024 –∏ —Ç. –¥.).

3.3. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ PG
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É–ª—É –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ PG:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (Total_OSD * 100) / Replica_Size
–ü—Ä–∏–º–µ—Ä:

–ï—Å–ª–∏ —É –≤–∞—Å 36 OSD, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è = 3:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (36 * 100) / 3 = 1200
–ï—Å–ª–∏ —É –≤–∞—Å 3 –ø—É–ª–∞, —Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—É–ª–∞:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG_per_pool = Total_PG / Number_of_Pools
PG_per_pool = 1200 / 3 = 400
3.4. –£–≤–µ–ª–∏—á–µ–Ω–∏–µ PG –Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–º –ø—É–ª–µ
–ï—Å–ª–∏ –ø—É–ª —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ PG –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ:

–£–≤–µ–ª–∏—á—å—Ç–µ pg_num:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set my-pool pg_num 768
–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á—å—Ç–µ pgp_num:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set my-pool pgp_num 768
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—É–ª–∞
–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –ø—É–ª–µ:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool get <pool-name> pg_num
ceph osd pool get <pool-name> pgp_num
5. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PG
–†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–æ—Ä–º—É–ª—É:

plaintext
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
PG = (Total_OSD * 100) / Replica_Size
–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG:

–°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pg_num.

–ó–∞—Ç–µ–º –∑–∞–¥–∞–π—Ç–µ pgp_num —Ä–∞–≤–Ω—ã–º pg_num.

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ceph -s –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏.

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ PG:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph pg stat
6. –í—ã–≤–æ–¥
–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –¥–ª—è –ø—É–ª–∞ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã pg_num –∏ pgp_num.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–¥–∞–≤–∞—Ç—å pg_num –∏ pgp_num —Ä–∞–≤–Ω—ã–º–∏ –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

–£–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ PG –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.

–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å! üöÄüòä







–í—ã —Å–∫–∞–∑–∞–ª–∏:
—Ç–æ  –µ—Å—Ç—å pg_num –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å on-line? –∏ –µ—Å–ª–∏ –∑–∞–¥–∞—Ç—å –±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á–µ–º —Ç–µ–∫—É—â–µ–µ, —Ç–æ pool —Ä–∞—Å—à–∏—Ä–∏—Ç—Å—è. –ê –º–æ–∂–Ω–æ –ª–∏ –∑–∞–¥–∞—Ç—å –º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ —É–º–µ–Ω—å—à–∏—Ç—å pool ? –Ω–∞–ø—Ä–∏–º–µ—Ä —á—Ç–æ–±—ã –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å pg –º–µ–∂–¥—É –ø—É–ª–∞–º–∏
ChatGPT —Å–∫–∞–∑–∞–ª:
–ú–æ–∂–Ω–æ –ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG (pg_num) –≤ –ø—É–ª–µ Ceph?
–ö–æ—Ä–æ—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –ù–µ—Ç, —É–º–µ–Ω—å—à–∏—Ç—å pg_num (—É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –ø—É–ª–µ) –Ω–µ–ª—å–∑—è.

Ceph –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∏–µ pg_num –¥–ª—è –ø—É–ª–∞, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–µ—Ä—å—ë–∑–Ω—ã–º –Ω–∞—Ä—É—à–µ–Ω–∏—è–º –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤. PG –≤ Ceph –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–∞–∫ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∏ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –º–µ–∂–¥—É –Ω–∏–º–∏. –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ PG –æ–∑–Ω–∞—á–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ PG, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

–ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è —É–º–µ–Ω—å—à–∏—Ç—å pg_num?
–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ:

–ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É PG, –∏—Ö –º–∏–≥—Ä–∞—Ü–∏—è –≤ –º–µ–Ω—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ —Å–ª–æ–∂–Ω–∞.

–£–¥–∞–ª–µ–Ω–∏–µ PG –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–æ—Ç–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å —ç—Ç–∏–º–∏ PG.

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

Ceph –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ pg_num, —á—Ç–æ–±—ã —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø—É–ª –∏ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ.

–£–º–µ–Ω—å—à–µ–Ω–∏–µ pg_num –Ω–µ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö.

–ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞:

–î–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è PG Ceph –ø—Ä–∏—à–ª–æ—Å—å –±—ã –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —É–¥–∞–ª—è–µ–º—ã—Ö PG –≤ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è, —á—Ç–æ –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ –±—ã –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø—Ä–∏–≤–µ–ª–æ –±—ã –∫ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–µ –∫–ª–∞—Å—Ç–µ—Ä–∞.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å PG –º–µ–∂–¥—É –ø—É–ª–∞–º–∏?
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –º–µ–∂–¥—É –ø—É–ª–∞–º–∏, –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–¥—Ö–æ–¥–∞–º–∏:

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—É–ª —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º PG
–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—É–ª —Å –∂–µ–ª–∞–µ–º—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º PG:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool create <new-pool-name> <desired_pg_num>
–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä–æ–≥–æ –ø—É–ª–∞ –≤ –Ω–æ–≤—ã–π –ø—É–ª:

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ rados export/import –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
rados export -p <old-pool-name> /tmp/export.bin
rados import -p <new-pool-name> /tmp/export.bin
–£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –ø—É–ª –ø–æ—Å–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool delete <old-pool-name> <old-pool-name> --yes-i-really-really-mean-it
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—É–ª —Å –¥—Ä—É–≥–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º PG –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –±–∞–∫–µ—Ç
–ï—Å–ª–∏ –ø—É–ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–∞–∫–µ—Ç–∞ RGW (RADOS Gateway):

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—É–ª —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º PG:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool create <new-pool-name> <desired_pg_num>
–ü—Ä–∏–≤—è–∂–∏—Ç–µ –±–∞–∫–µ—Ç –∫ –Ω–æ–≤–æ–º—É –ø—É–ª—É:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
radosgw-admin bucket placement modify --bucket=<bucket-name> --placement-id=<new-pool-name>
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å PG –≤ –¥—Ä—É–≥–∏—Ö –ø—É–ª–∞—Ö
–ï—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ –ø—É–ª–æ–≤ –∏–º–µ–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ PG:

–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ PG (pg_num) –≤ –¥—Ä—É–≥–∏—Ö –ø—É–ª–∞—Ö:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool set <pool-name> pg_num <new_pg_num>
ceph osd pool set <pool-name> pgp_num <new_pg_num>
–≠—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Ä–µ—Å—É—Ä—Å–æ–≤ –º–µ–∂–¥—É –ø—É–ª–∞–º–∏.

–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —É–∂–µ –∏—Å—á–µ—Ä–ø–∞–Ω—ã?
–ï—Å–ª–∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –ø—É–ª–æ–≤):

–°–æ–∫—Ä–∞—Ç–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É–ª–æ–≤:

–£–¥–∞–ª–∏—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—É–ª—ã:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
ceph osd pool delete <pool-name> <pool-name> --yes-i-really-really-mean-it
–ü–µ—Ä–µ–Ω–æ—Å–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å—Ç–∞—Ä—ã—Ö –ø—É–ª–æ–≤ –≤ –Ω–æ–≤—ã–µ.

–î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ OSD:

–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ OSD –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.

–ò—Ç–æ–≥
pg_num –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å, —É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å PG:

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—É–ª –∏ –ø–µ—Ä–µ–Ω–µ—Å–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ.

–õ–∏–±–æ —É–≤–µ–ª–∏—á—å—Ç–µ PG –≤ –¥—Ä—É–≥–∏—Ö –ø—É–ª–∞—Ö –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏.

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–∏–º–∏—Ç–∞–º–∏ PG –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ, —É—á–∏—Ç—ã–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (OSD, –ø–∞–º—è—Ç—å).
